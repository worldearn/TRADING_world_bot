<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EARNING WORLD.COM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #6c5ce7;
            --secondary: #a29bfe;
            --accent: #00cec9;
            --dark: #2d3436;
            --light: #f5f6fa;
            --success: #00b894;
            --warning: #fdcb6e;
            --danger: #d63031;
            --info: #0984e3;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f8f9fa;
            color: var(--dark);
        }

        /* Header */
        header {
            background: white;
            padding: 15px 5%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
        }

        .logo span {
            color: var(--accent);
        }

        /* Auth Container */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 80px 20px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .auth-box {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 450px;
            overflow: hidden;
        }

        .auth-header {
            padding: 25px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .auth-header h1 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .auth-form {
            padding: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
        }

        .btn {
            display: inline-block;
            padding: 12px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            width: 100%;
        }

        .btn:hover {
            background: #5649c9;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-success {
            background: var(--success);
        }

        .btn-danger {
            background: var(--danger);
        }

        .auth-footer {
            text-align: center;
            padding: 15px;
            border-top: 1px solid #eee;
            font-size: 14px;
        }

        .auth-footer a {
            color: var(--primary);
            text-decoration: none;
        }

        /* User Dashboard (Mobile) */
        .user-dashboard {
            display: none;
            padding: 20px;
            padding-top: 80px;
            max-width: 500px;
            margin: 0 auto;
        }

        .balance-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 20px rgba(108, 92, 231, 0.2);
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        /* Agent Dashboard (Desktop) */
        .agent-dashboard {
            display: none;
            padding: 20px;
            padding-top: 80px;
        }

        .agent-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .agent-info {
            display: flex;
            align-items: center;
        }

        .agent-avatar {
            width: 60px;
            height: 60px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            color: white;
            font-size: 24px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-success {
            background: #e8f5e9;
            color: var(--success);
        }

        .badge-warning {
            background: #fff8e1;
            color: #ff8f00;
        }

        .badge-danger {
            background: #ffebee;
            color: var(--danger);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .auth-form {
                padding: 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .agent-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        @media (min-width: 992px) {
            .agent-dashboard {
                padding: 30px 50px;
                padding-top: 90px;
            }
            
            .agent-header {
                margin-bottom: 40px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 20px;
                margin-bottom: 30px;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .auth-box {
                border-radius: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo">EARNING<span>WORLD</span>.COM</div>
        <div id="headerLinks">
            <a href="#" id="loginLink" style="color: var(--dark); text-decoration: none; margin-right: 15px;">Login</a>
            <a href="#" id="signupLink" style="color: var(--dark); text-decoration: none;">Sign Up</a>
        </div>
    </header>

    <!-- Auth Container -->
    <div class="auth-container" id="authSection">
        <div class="auth-box">
            <div class="auth-header">
                <h1 id="authTitle">User Login</h1>
                <p id="authSubtitle">Access your account</p>
            </div>
            
            <div class="auth-form" id="loginForm">
                <div class="form-group">
                    <label id="loginLabel">Email</label>
                    <input type="text" id="loginInput" class="form-control" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password" required>
                </div>
                <button type="button" class="btn" id="loginBtn">Login</button>
                <div style="text-align: center; margin-top: 15px;">
                    <a href="#" id="switchToAgent" style="color: var(--primary); text-decoration: none;">Agent Login</a>
                </div>
            </div>
            
            <div class="auth-form" id="agentLoginForm" style="display: none;">
                <div class="form-group">
                    <label>Agent ID</label>
                    <input type="text" id="agentId" class="form-control" placeholder="Enter your agent ID" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="agentPassword" class="form-control" placeholder="Enter your password" required>
                </div>
                <button type="button" class="btn" id="agentLoginBtn">Login</button>
                <div style="text-align: center; margin-top: 15px;">
                    <a href="#" id="switchToUser" style="color: var(--primary); text-decoration: none;">User Login</a>
                </div>
            </div>
            
            <div class="auth-form" id="signupForm" style="display: none;">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="userName" class="form-control" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="userEmail" class="form-control" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label>Password (min 6 characters)</label>
                    <input type="password" id="userPassword" class="form-control" placeholder="Create a password" minlength="6" required>
                </div>
                <div class="form-group">
                    <label>Referral Code (Optional)</label>
                    <input type="text" id="userReferral" class="form-control" placeholder="Enter referral code if any">
                </div>
                <button type="button" class="btn" id="signupBtn">Create Account</button>
                <div style="text-align: center; margin-top: 15px;">
                    <p style="color: #666;">Already have an account? <a href="#" id="switchToLogin" style="color: var(--primary);">Login</a></p>
                </div>
            </div>
            
            <div class="auth-footer">
                <p>Need help? Contact our <a href="https://t.me/CostumereCare_Bot" target="_blank">Telegram Support</a></p>
            </div>
        </div>
    </div>

    <!-- User Dashboard (Mobile) -->
    <div class="user-dashboard" id="userDashboard">
        <div class="balance-card">
            <h3 style="margin-bottom: 10px; font-weight: 500;">Available Balance</h3>
            <h1 id="userBalance" style="font-size: 36px; margin-bottom: 20px;">$0.00</h1>
            <div style="display: flex; gap: 10px;">
                <button class="btn" onclick="showDeposit()">Deposit</button>
                <button class="btn btn-secondary" onclick="showWithdraw()">Withdraw</button>
            </div>
        </div>
        
        <div class="card">
            <h3 style="margin-bottom: 15px;">Daily Task</h3>
            <p id="taskStatus" style="margin-bottom: 15px;">Complete your daily task to earn rewards</p>
            <button class="btn" id="taskBtn" onclick="completeTask()">Complete Task</button>
            <p id="taskTimer" style="margin-top: 15px; font-size: 14px; color: #666;"></p>
        </div>
        
        <div class="card">
            <h3 style="margin-bottom: 15px;">VIP Status</h3>
            <p id="vipStatus" style="margin-bottom: 15px;">No VIP Package</p>
            <button class="btn btn-success" onclick="showVipPackages()">Upgrade VIP</button>
        </div>
        
        <div class="card">
            <h3 style="margin-bottom: 15px;">Referral Program</h3>
            <p style="margin-bottom: 10px;">Earn 10% of your referrals' deposits</p>
            <div class="form-group">
                <label>Your Referral Link</label>
                <div style="display: flex;">
                    <input type="text" id="referralLink" class="form-control" readonly style="border-top-right-radius: 0; border-bottom-right-radius: 0;">
                    <button class="btn" onclick="copyReferralLink()" style="width: auto; border-top-left-radius: 0; border-bottom-left-radius: 0;">Copy</button>
                </div>
            </div>
            <p style="margin-top: 15px; font-size: 14px; color: #666;">Share your link and earn passive income!</p>
        </div>
        
        <div class="card">
            <h3 style="margin-bottom: 15px;">Customer Support</h3>
            <p style="margin-bottom: 15px;">Need help? Contact our support team:</p>
            <a href="https://t.me/CostumereCare_Bot" target="_blank" class="btn" style="background: #0088cc; display: flex; align-items: center; justify-content: center;">
                <i class="fab fa-telegram" style="margin-right: 8px;"></i> Telegram Support
            </a>
        </div>
        
        <div style="text-align: center; margin-top: 30px;">
            <button class="btn btn-danger" onclick="logout()">Logout</button>
        </div>
    </div>

    <!-- Agent Dashboard (Desktop) -->
    <div class="agent-dashboard" id="agentDashboard">
        <div class="agent-header">
            <div class="agent-info">
                <div class="agent-avatar">
                    <i class="fas fa-user-tie"></i>
                </div>
                <div>
                    <h2 id="agentName">Agent Name</h2>
                    <p id="agentIdDisplay" style="color: #666;">ID: AGENT001</p>
                </div>
            </div>
            <button class="btn btn-danger" id="agentLogoutBtn">Logout</button>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalUsers">3</div>
                <div class="stat-label">Assigned Users</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="activeUsers">0</div>
                <div class="stat-label">Active Today</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalEarnings">$0.00</div>
                <div class="stat-label">Total Earnings</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="pendingActions">0</div>
                <div class="stat-label">Pending Actions</div>
            </div>
        </div>
        
        <h2 style="margin-bottom: 15px;">Pending Approvals</h2>
        <div class="card">
            <div class="table-responsive">
                <table id="approvalTable">
                    <thead>
                        <tr>
                            <th>User</th>
                            <th>Type</th>
                            <th>Amount</th>
                            <th>Date</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="5">Loading pending requests...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <h2 style="margin-bottom: 15px;">Your Users</h2>
        <div class="card">
            <div class="table-responsive">
                <table id="usersTable">
                    <thead>
                        <tr>
                            <th>User Name</th>
                            <th>VIP Level</th>
                            <th>Balance</th>
                            <th>Task Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="5">Loading user data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- VIP Packages Modal -->
    <div id="vipModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <h2 style="margin-bottom: 20px;">VIP Packages</h2>
            <div id="vipPackagesList">
                <!-- Packages will be loaded here -->
            </div>
            <button class="btn btn-danger" onclick="hideModal('vipModal')" style="margin-top: 20px; width: 100%;">Cancel</button>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div id="depositModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%;">
            <h2 style="margin-bottom: 20px;">Deposit Funds</h2>
            <div class="form-group">
                <label for="depositAmount">Amount ($)</label>
                <input type="number" id="depositAmount" class="form-control" min="10">
            </div>
            <div class="form-group">
                <label for="depositMethod">Payment Method</label>
                <select id="depositMethod" class="form-control">
                    <option value="binance">Binance (TRC20)</option>
                    <option value="solana">Solana</option>
                </select>
            </div>
            <div class="form-group">
                <label>Wallet Address</label>
                <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; word-break: break-all; font-size: 14px;" id="walletAddress">
                    TRC20: TXoWzutmFoaXhr8g7KUoc3QXZegpQHzsfe
                </div>
            </div>
            <button class="btn" onclick="submitDeposit()">Submit Deposit Request</button>
            <button class="btn btn-danger" onclick="hideModal('depositModal')" style="margin-top: 10px;">Cancel</button>
        </div>
    </div>

    <!-- Withdraw Modal -->
    <div id="withdrawModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%;">
            <h2 style="margin-bottom: 20px;">Withdraw Funds</h2>
            <div class="form-group">
                <label for="withdrawAmount">Amount ($)</label>
                <input type="number" id="withdrawAmount" class="form-control" min="10">
            </div>
            <div class="form-group">
                <label for="withdrawMethod">Payment Method</label>
                <select id="withdrawMethod" class="form-control">
                    <option value="binance">Binance (TRC20)</option>
                    <option value="solana">Solana</option>
                </select>
            </div>
            <div class="form-group">
                <label for="withdrawAddress">Your Wallet Address</label>
                <input type="text" id="withdrawAddress" class="form-control" placeholder="Enter your wallet address">
            </div>
            <button class="btn" onclick="submitWithdraw()">Submit Withdrawal Request</button>
            <button class="btn btn-danger" onclick="hideModal('withdrawModal')" style="margin-top: 10px;">Cancel</button>
        </div>
    </div>

    <script>
        // Database Simulation
        let users = [];
        let agents = [];
        let transactions = [];
        let currentUser = null;
        let currentAgent = null;
        
        // Initialize with sample data
        function initializeData() {
            // Sample agents
            agents = [
                {
                    id: "AGENT001",
                    password: "agent123",
                    name: "John Doe",
                    assignedUsers: ["USER001", "USER002", "USER003"]
                },
                {
                    id: "AGENT002",
                    password: "agent456",
                    name: "Jane Smith",
                    assignedUsers: ["USER004", "USER005", "USER006"]
                }
            ];
            
            // Sample users
            users = [
                {
                    id: "USER001",
                    name: "Michael Brown",
                    email: "michael@example.com",
                    password: "user123",
                    balance: 350.00,
                    vipLevel: 3,
                    lastTaskCompletion: new Date(Date.now() - 12 * 60 * 60 * 1000).toISOString(),
                    referredBy: null,
                    referrals: [],
                    agentId: "AGENT001"
                },
                {
                    id: "USER002",
                    name: "Sarah Johnson",
                    email: "sarah@example.com",
                    password: "user123",
                    balance: 120.00,
                    vipLevel: 2,
                    lastTaskCompletion: new Date(Date.now() - 36 * 60 * 60 * 1000).toISOString(),
                    referredBy: null,
                    referrals: [],
                    agentId: "AGENT001"
                },
                {
                    id: "USER003",
                    name: "David Wilson",
                    email: "david@example.com",
                    password: "user123",
                    balance: 60.00,
                    vipLevel: 1,
                    lastTaskCompletion: new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),
                    referredBy: null,
                    referrals: [],
                    agentId: "AGENT001"
                },
                {
                    id: "USER004",
                    name: "Emily Davis",
                    email: "emily@example.com",
                    password: "user123",
                    balance: 520.00,
                    vipLevel: 4,
                    lastTaskCompletion: null,
                    referredBy: null,
                    referrals: [],
                    agentId: "AGENT002"
                },
                {
                    id: "USER005",
                    name: "Robert Taylor",
                    email: "robert@example.com",
                    password: "user123",
                    balance: 110.00,
                    vipLevel: 2,
                    lastTaskCompletion: new Date(Date.now() - 6 * 60 * 60 * 1000).toISOString(),
                    referredBy: null,
                    referrals: [],
                    agentId: "AGENT002"
                },
                {
                    id: "USER006",
                    name: "Lisa Anderson",
                    email: "lisa@example.com",
                    password: "user123",
                    balance: 1050.00,
                    vipLevel: 5,
                    lastTaskCompletion: new Date(Date.now() - 3 * 60 * 60 * 1000).toISOString(),
                    referredBy: null,
                    referrals: [],
                    agentId: "AGENT002"
                }
            ];
            
            // Sample transactions
            transactions = [
                {
                    id: "TXN001",
                    userId: "USER001",
                    type: "deposit",
                    amount: 300,
                    method: "binance",
                    status: "completed",
                    date: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),
                    approvedBy: "AGENT001"
                },
                {
                    id: "TXN002",
                    userId: "USER002",
                    type: "deposit",
                    amount: 100,
                    method: "solana",
                    status: "completed",
                    date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
                    approvedBy: "AGENT001"
                },
                {
                    id: "TXN003",
                    userId: "USER003",
                    type: "withdrawal",
                    amount: 50,
                    method: "binance",
                    status: "pending",
                    date: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString()
                },
                {
                    id: "TXN004",
                    userId: "USER004",
                    type: "deposit",
                    amount: 500,
                    method: "solana",
                    status: "completed",
                    date: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000).toISOString(),
                    approvedBy: "AGENT002"
                },
                {
                    id: "TXN005",
                    userId: "USER005",
                    type: "withdrawal",
                    amount: 30,
                    method: "binance",
                    status: "pending",
                    date: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString()
                }
            ];
            
            // VIP Packages
            window.vipPackages = [
                { id: 1, amount: 50, percent: 5, name: "Starter" },
                { id: 2, amount: 100, percent: 6, name: "Basic" },
                { id: 3, amount: 300, percent: 7, name: "Advanced" },
                { id: 4, amount: 500, percent: 8, name: "Professional" },
                { id: 5, amount: 1000, percent: 10, name: "Premium" }
            ];
        }
        
        // Initialize the app
        function init() {
            initializeData();
            
            // Check if user/agent is already logged in
            const savedUser = localStorage.getItem('earningWorldUser');
            const savedAgent = localStorage.getItem('earningWorldAgent');
            
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showUserDashboard();
            } else if (savedAgent) {
                currentAgent = JSON.parse(savedAgent);
                showAgentDashboard();
            }
            
            // Setup auth navigation
            document.getElementById('loginLink').addEventListener('click', function(e) {
                e.preventDefault();
                showAuthSection();
                showLoginForm();
            });
            
            document.getElementById('signupLink').addEventListener('click', function(e) {
                e.preventDefault();
                showAuthSection();
                showSignupForm();
            });
            
            document.getElementById('switchToAgent').addEventListener('click', function(e) {
                e.preventDefault();
                showAgentLoginForm();
            });
            
            document.getElementById('switchToUser').addEventListener('click', function(e) {
                e.preventDefault();
                showLoginForm();
            });
            
            document.getElementById('switchToLogin').addEventListener('click', function(e) {
                e.preventDefault();
                showLoginForm();
            });
            
            // Setup login buttons
            document.getElementById('loginBtn').addEventListener('click', userLogin);
            document.getElementById('agentLoginBtn').addEventListener('click', agentLogin);
            document.getElementById('signupBtn').addEventListener('click', userSignup);
            
            // Setup logout buttons
            document.getElementById('agentLogoutBtn').addEventListener('click', logout);
            
            // Setup deposit method change
            document.getElementById('depositMethod').addEventListener('change', updateDepositAddress);
        }
        
        // Show auth section
        function showAuthSection() {
            document.getElementById('authSection').style.display = 'flex';
            document.getElementById('userDashboard').style.display = 'none';
            document.getElementById('agentDashboard').style.display = 'none';
        }
        
        // Show login form
        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('agentLoginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('authTitle').textContent = 'User Login';
            document.getElementById('authSubtitle').textContent = 'Access your account';
            document.getElementById('loginLabel').textContent = 'Email';
            document.getElementById('loginInput').placeholder = 'Enter your email';
            document.getElementById('loginInput').type = 'email';
        }
        
        // Show agent login form
        function showAgentLoginForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('agentLoginForm').style.display = 'block';
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('authTitle').textContent = 'Agent Login';
            document.getElementById('authSubtitle').textContent = 'Access agent dashboard';
        }
        
        // Show signup form
        function showSignupForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('agentLoginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
            document.getElementById('authTitle').textContent = 'User Signup';
            document.getElementById('authSubtitle').textContent = 'Create new account';
        }
        
        // User login
        function userLogin() {
            const email = document.getElementById('loginInput').value;
            const password = document.getElementById('loginPassword').value;
            
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('earningWorldUser', JSON.stringify(user));
                showUserDashboard();
            } else {
                alert('Invalid email or password');
            }
        }
        
        // Agent login
        function agentLogin() {
            const agentId = document.getElementById('agentId').value;
            const password = document.getElementById('agentPassword').value;
            
            const agent = agents.find(a => a.id === agentId && a.password === password);
            
            if (agent) {
                currentAgent = agent;
                localStorage.setItem('earningWorldAgent', JSON.stringify(agent));
                showAgentDashboard();
            } else {
                alert('Invalid Agent ID or Password');
            }
        }
        
        // User signup
        function userSignup() {
            const name = document.getElementById('userName').value;
            const email = document.getElementById('userEmail').value;
            const password = document.getElementById('userPassword').value;
            const referral = document.getElementById('userReferral').value;
            
            // Check if email already exists
            if (users.some(u => u.email === email)) {
                alert('Email already registered');
                return;
            }
            
            // Create new user
            const newUser = {
                id: 'USER' + Math.floor(1000 + Math.random() * 9000),
                name,
                email,
                password,
                balance: 0,
                vipLevel: null,
                lastTaskCompletion: null,
                referredBy: referral || null,
                referrals: [],
                agentId: Math.random() > 0.5 ? "AGENT001" : "AGENT002" // Randomly assign to an agent
            };
            
            users.push(newUser);
            currentUser = newUser;
            localStorage.setItem('earningWorldUser', JSON.stringify(newUser));
            showUserDashboard();
            
            // Update agent's assigned users
            const agent = agents.find(a => a.id === newUser.agentId);
            if (agent && agent.assignedUsers.length < 3) {
                agent.assignedUsers.push(newUser.id);
            }
            
            alert('Registration successful!');
        }
        
        // Show user dashboard
        function showUserDashboard() {
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('agentDashboard').style.display = 'none';
            document.getElementById('userDashboard').style.display = 'block';
            
            updateUserDashboard();
        }
        
        // Update user dashboard
        function updateUserDashboard() {
            if (!currentUser) return;
            
            // Update balance
            document.getElementById('userBalance').textContent = '$' + currentUser.balance.toFixed(2);
            
            // Update VIP status
            const vipStatus = document.getElementById('vipStatus');
            if (currentUser.vipLevel) {
                const pkg = window.vipPackages.find(p => p.id === currentUser.vipLevel);
                vipStatus.textContent = `${pkg.name} Package (${pkg.percent}% Daily)`;
            } else {
                vipStatus.textContent = 'No VIP Package';
            }
            
            // Update task status
            const taskBtn = document.getElementById('taskBtn');
            const taskStatus = document.getElementById('taskStatus');
            const taskTimer = document.getElementById('taskTimer');
            
            if (!currentUser.vipLevel) {
                taskStatus.textContent = 'Purchase a VIP package to start earning';
                taskBtn.disabled = true;
                taskTimer.textContent = '';
                return;
            }
            
            const now = new Date();
            const lastCompletion = currentUser.lastTaskCompletion ? new Date(currentUser.lastTaskCompletion) : null;
            
            if (lastCompletion && isSameDay(now, lastCompletion)) {
                taskStatus.textContent = 'Task already completed today';
                taskBtn.disabled = true;
                
                // Calculate next available task time
                const nextDay = new Date(lastCompletion);
                nextDay.setDate(nextDay.getDate() + 1);
                nextDay.setHours(0, 0, 0, 0);
                
                updateCountdown(nextDay, taskTimer, taskBtn, taskStatus);
            } else {
                taskStatus.textContent = 'Complete your daily task to earn rewards';
                taskBtn.disabled = false;
                taskTimer.textContent = '';
            }
            
            // Update referral link
            document.getElementById('referralLink').value = window.location.href.split('?')[0] + '?ref=' + currentUser.id;
        }
        
        // Update countdown timer
        function updateCountdown(targetDate, timerElement, buttonElement, statusElement) {
            const update = () => {
                const now = new Date();
                const diff = targetDate - now;
                
                if (diff <= 0) {
                    statusElement.textContent = 'Task available';
                    buttonElement.disabled = false;
                    timerElement.textContent = '';
                    return;
                }
                
                const hours = Math.floor(diff / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                
                timerElement.textContent = `Next task in: ${hours}h ${minutes}m ${seconds}s`;
            };
            
            update();
            window.taskInterval = setInterval(update, 1000);
        }
        
        // Complete daily task
        function completeTask() {
            if (!currentUser || !currentUser.vipLevel) return;
            
            const pkg = window.vipPackages.find(p => p.id === currentUser.vipLevel);
            const earnings = (pkg.amount * pkg.percent) / 100;
            
            currentUser.balance += earnings;
            currentUser.lastTaskCompletion = new Date().toISOString();
            
            // Add transaction
            transactions.push({
                id: 'TXN' + Math.floor(1000 + Math.random() * 9000),
                userId: currentUser.id,
                type: 'earning',
                amount: earnings,
                date: new Date().toISOString(),
                status: 'completed'
            });
            
            localStorage.setItem('earningWorldUser', JSON.stringify(currentUser));
            updateUserDashboard();
            alert(`Task completed! You earned $${earnings.toFixed(2)}`);
        }
        
        // Show agent dashboard
        function showAgentDashboard() {
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('userDashboard').style.display = 'none';
            document.getElementById('agentDashboard').style.display = 'block';
            
            updateAgentDashboard();
        }
        
        // Update agent dashboard
        function updateAgentDashboard() {
            if (!currentAgent) return;
            
            // Update agent info
            document.getElementById('agentName').textContent = currentAgent.name;
            document.getElementById('agentIdDisplay').textContent = 'ID: ' + currentAgent.id;
            
            // Get assigned users
            const assignedUsers = users.filter(u => currentAgent.assignedUsers.includes(u.id));
            
            // Update stats
            document.getElementById('totalUsers').textContent = assignedUsers.length;
            document.getElementById('activeUsers').textContent = assignedUsers.filter(u => {
                if (!u.lastTaskCompletion) return false;
                return isSameDay(new Date(), new Date(u.lastTaskCompletion));
            }).length;
            
            // Calculate total earnings from VIP packages
            const totalEarnings = assignedUsers.reduce((sum, user) => {
                if (!user.vipLevel) return sum;
                const pkg = window.vipPackages.find(p => p.id === user.vipLevel);
                return sum + (pkg.amount * pkg.percent / 100);
            }, 0);
            
            document.getElementById('totalEarnings').textContent = '$' + totalEarnings.toFixed(2);
            
            // Get pending actions
            const pendingActions = transactions.filter(t => 
                t.status === 'pending' && 
                assignedUsers.some(u => u.id === t.userId)
            );
            
            document.getElementById('pendingActions').textContent = pendingActions.length;
            
            // Update approval table
            const approvalTable = document.getElementById('approvalTable').querySelector('tbody');
            approvalTable.innerHTML = '';
            
            pendingActions.forEach(txn => {
                const user = users.find(u => u.id === txn.userId);
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${user ? user.name : 'Unknown User'}</td>
                    <td>${txn.type === 'deposit' ? 'Deposit' : 'Withdrawal'}</td>
                    <td>$${txn.amount.toFixed(2)}</td>
                    <td>${formatDate(txn.date)}</td>
                    <td>
                        ${txn.type === 'deposit' ? 
                            `<button class="btn btn-success" onclick="approveTransaction('${txn.id}')" style="padding: 5px 10px; font-size: 12px;">Approve</button>` : 
                            `<button class="btn btn-success" onclick="approveTransaction('${txn.id}')" style="padding: 5px 10px; font-size: 12px; margin-right: 5px;">Approve</button>
                             <button class="btn btn-danger" onclick="rejectTransaction('${txn.id}')" style="padding: 5px 10px; font-size: 12px;">Reject</button>`
                        }
                    </td>
                `;
                
                approvalTable.appendChild(row);
            });
            
            if (pendingActions.length === 0) {
                approvalTable.innerHTML = '<tr><td colspan="5">No pending requests</td></tr>';
            }
            
            // Update users table
            const usersTable = document.getElementById('usersTable').querySelector('tbody');
            usersTable.innerHTML = '';
            
            assignedUsers.forEach(user => {
                const pkg = user.vipLevel ? window.vipPackages.find(p => p.id === user.vipLevel) : null;
                const taskCompleted = user.lastTaskCompletion && isSameDay(new Date(), new Date(user.lastTaskCompletion));
                
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${user.name}</td>
                    <td>${pkg ? `VIP ${user.vipLevel} (${pkg.percent}%)` : 'None'}</td>
                    <td>$${user.balance.toFixed(2)}</td>
                    <td><span class="badge ${taskCompleted ? 'badge-success' : 'badge-warning'}">${taskCompleted ? 'Completed' : 'Pending'}</span></td>
                    <td><button class="btn" onclick="viewUserDetails('${user.id}')" style="padding: 5px 10px; font-size: 12px;">View</button></td>
                `;
                
                usersTable.appendChild(row);
            });
        }
        
        // Approve transaction
        function approveTransaction(txnId) {
            const txn = transactions.find(t => t.id === txnId);
            if (!txn) return;
            
            txn.status = 'completed';
            txn.approvedBy = currentAgent.id;
            
            if (txn.type === 'deposit') {
                const user = users.find(u => u.id === txn.userId);
                if (user) {
                    user.balance += txn.amount;
                    
                    // Check if this is a VIP package purchase
                    const pkg = window.vipPackages.find(p => p.amount === txn.amount);
                    if (pkg) {
                        user.vipLevel = pkg.id;
                    }
                    
                    // Process referral bonus if applicable
                    if (user.referredBy) {
                        const referrer = users.find(u => u.id === user.referredBy);
                        if (referrer) {
                            const bonus = txn.amount * 0.1; // 10% referral bonus
                            referrer.balance += bonus;
                            
                            // Add referral transaction
                            transactions.push({
                                id: 'TXN' + Math.floor(1000 + Math.random() * 9000),
                                userId: referrer.id,
                                type: 'referral',
                                amount: bonus,
                                date: new Date().toISOString(),
                                status: 'completed'
                            });
                        }
                    }
                }
            } else if (txn.type === 'withdrawal') {
                const user = users.find(u => u.id === txn.userId);
                if (user) {
                    user.balance -= txn.amount;
                }
            }
            
            updateAgentDashboard();
            alert('Transaction approved successfully');
        }
        
        // Reject transaction
        function rejectTransaction(txnId) {
            const txn = transactions.find(t => t.id === txnId);
            if (!txn) return;
            
            txn.status = 'rejected';
            txn.approvedBy = currentAgent.id;
            
            updateAgentDashboard();
            alert('Transaction rejected');
        }
        
        // View user details
        function viewUserDetails(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;
            
            alert(`User Details:\n\nName: ${user.name}\nEmail: ${user.email}\nBalance: $${user.balance.toFixed(2)}\nVIP Level: ${user.vipLevel || 'None'}\nLast Task: ${user.lastTaskCompletion ? formatDate(user.lastTaskCompletion) : 'Never'}`);
        }
        
        // Show VIP packages
        function showVipPackages() {
            const packagesList = document.getElementById('vipPackagesList');
            packagesList.innerHTML = '';
            
            window.vipPackages.forEach(pkg => {
                const pkgElement = document.createElement('div');
                pkgElement.style.marginBottom = '15px';
                pkgElement.style.padding = '15px';
                pkgElement.style.border = '1px solid #eee';
                pkgElement.style.borderRadius = '8px';
                
                pkgElement.innerHTML = `
                    <h3 style="margin-bottom: 10px;">${pkg.name} Package - $${pkg.amount}</h3>
                    <p style="margin-bottom: 10px; color: #666;">Earn ${pkg.percent}% daily return</p>
                    <button class="btn" onclick="purchaseVip(${pkg.id})" style="width: 100%;">Purchase</button>
                `;
                
                packagesList.appendChild(pkgElement);
            });
            
            showModal('vipModal');
        }
        
        // Purchase VIP package
        function purchaseVip(packageId) {
            const pkg = window.vipPackages.find(p => p.id === packageId);
            if (!pkg) return;
            
            if (confirm(`Are you sure you want to purchase the ${pkg.name} package for $${pkg.amount}?`)) {
                // Add deposit transaction (needs agent approval)
                transactions.push({
                    id: 'TXN' + Math.floor(1000 + Math.random() * 9000),
                    userId: currentUser.id,
                    type: 'deposit',
                    amount: pkg.amount,
                    method: 'vip_purchase',
                    status: 'pending',
                    date: new Date().toISOString()
                });
                
                hideModal('vipModal');
                alert('Your VIP package purchase request has been submitted. It will be activated after agent approval.');
            }
        }
        
        // Show deposit modal
        function showDeposit() {
            document.getElementById('depositAmount').value = '';
            updateDepositAddress();
            showModal('depositModal');
        }
        
        // Update deposit address based on method
        function updateDepositAddress() {
            const method = document.getElementById('depositMethod').value;
            document.getElementById('walletAddress').textContent = method === 'binance' ? 
                'TRC20: TXoWzutmFoaXhr8g7KUoc3QXZegpQHzsfe' : 
                'Solana: BB4s5CKobWxoptwgat33zzwdfkdQ17c48pKJywYd4odw';
        }
        
        // Submit deposit
        function submitDeposit() {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            const method = document.getElementById('depositMethod').value;
            
            if (isNaN(amount)) {
                alert('Please enter a valid amount');
                return;
            }
            
            if (amount < 10) {
                alert('Minimum deposit amount is $10');
                return;
            }
            
            // Add deposit transaction (needs agent approval)
            transactions.push({
                id: 'TXN' + Math.floor(1000 + Math.random() * 9000),
                userId: currentUser.id,
                type: 'deposit',
                amount: amount,
                method: method,
                status: 'pending',
                date: new Date().toISOString()
            });
            
            hideModal('depositModal');
            alert(`Deposit request for $${amount.toFixed(2)} submitted. Please send funds to the provided address. Your deposit will be credited after agent approval.`);
        }
        
        // Show withdraw modal
        function showWithdraw() {
            document.getElementById('withdrawAmount').value = '';
            document.getElementById('withdrawAddress').value = '';
            showModal('withdrawModal');
        }
        
        // Submit withdrawal
        function submitWithdraw() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const method = document.getElementById('withdrawMethod').value;
            const address = document.getElementById('withdrawAddress').value;
            
            if (isNaN(amount)) {
                alert('Please enter a valid amount');
                return;
            }
            
            if (amount < 10) {
                alert('Minimum withdrawal amount is $10');
                return;
            }
            
            if (amount > currentUser.balance) {
                alert('Insufficient balance');
                return;
            }
            
            if (!address) {
                alert('Please enter your wallet address');
                return;
            }
            
            // Add withdrawal transaction (needs agent approval)
            transactions.push({
                id: 'TXN' + Math.floor(1000 + Math.random() * 9000),
                userId: currentUser.id,
                type: 'withdrawal',
                amount: amount,
                method: method,
                address: address,
                status: 'pending',
                date: new Date().toISOString()
            });
            
            hideModal('withdrawModal');
            alert(`Withdrawal request for $${amount.toFixed(2)} submitted. It will be processed after agent approval.`);
        }
        
        // Copy referral link
        function copyReferralLink() {
            const linkInput = document.getElementById('referralLink');
            linkInput.select();
            document.execCommand('copy');
            alert('Referral link copied to clipboard!');
        }
        
        // Show modal
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }
        
        // Hide modal
        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Logout
        function logout() {
            currentUser = null;
            currentAgent = null;
            localStorage.removeItem('earningWorldUser');
            localStorage.removeItem('earningWorldAgent');
            showAuthSection();
            showLoginForm();
            
            // Clear any intervals
            clearInterval(window.taskInterval);
        }
        
        // Helper function to check if two dates are the same day
        function isSameDay(date1, date2) {
            return date1.getFullYear() === date2.getFullYear() &&
                   date1.getMonth() === date2.getMonth() &&
                   date1.getDate() === date2.getDate();
        }
        
        // Format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
        }
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>